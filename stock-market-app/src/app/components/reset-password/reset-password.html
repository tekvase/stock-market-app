<div class="reset-container">
  <div class="reset-card">
    <!-- Validating token -->
    <div *ngIf="isValidating" class="loading-section">
      <div class="spinner" aria-hidden="true"></div>
      <p role="status">Validating reset link...</p>
    </div>

    <!-- Invalid token -->
    <div *ngIf="!isValidating && !tokenValid && !resetComplete">
      <div class="reset-header">
        <h1>Link Expired</h1>
      </div>
      <div class="error-section">
        <div class="error-icon" aria-hidden="true">&#10007;</div>
        <p class="error-text">{{ errorMessage }}</p>
        <a [routerLink]="['/forgot-password']" class="action-button">Request New Reset Link</a>
      </div>
      <div class="back-link">
        <p><a [routerLink]="['/login']">Back to Sign In</a></p>
      </div>
    </div>

    <!-- Valid token - show form -->
    <div *ngIf="!isValidating && tokenValid && !resetComplete">
      <div class="reset-header">
        <h1>Create New Password</h1>
        <p>Enter a new password for <strong>{{ email }}</strong></p>
      </div>

      <form (ngSubmit)="onSubmit()" class="reset-form">
        <div class="form-group">
          <label for="newPassword">New Password</label>
          <input
            type="password"
            id="newPassword"
            [(ngModel)]="newPassword"
            name="newPassword"
            placeholder="Enter new password (min 6 characters)"
            required
            [disabled]="isLoading"
          />
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input
            type="password"
            id="confirmPassword"
            [(ngModel)]="confirmPassword"
            name="confirmPassword"
            placeholder="Confirm new password"
            required
            [disabled]="isLoading"
          />
        </div>

        <div *ngIf="errorMessage" class="error-message" role="alert">
          {{ errorMessage }}
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading">
          <span *ngIf="!isLoading">Reset Password</span>
          <span *ngIf="isLoading">Resetting...</span>
        </button>
      </form>
    </div>

    <!-- Reset complete -->
    <div *ngIf="resetComplete">
      <div class="reset-header">
        <h1>Password Reset</h1>
      </div>
      <div class="success-section">
        <div class="success-icon" aria-hidden="true">&#10003;</div>
        <div class="success-message" role="status">{{ successMessage }}</div>
        <button class="action-button" (click)="goToLogin()" type="button">Sign In Now</button>
      </div>
    </div>
  </div>
</div>
